<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kuntur - Sistema AntiExtorsiones</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css" rel="stylesheet"/>
  <link href="{{ url_for('static', filename='styles.css') }}" rel="stylesheet"/>
  <link href="{{ url_for('static', filename='styles_index.css') }}" rel="stylesheet"/>
</head>
<body class="dashboard-body">

<!-- Background -->
<div class="dashboard-background">
  <img src="{{ url_for('static', filename='Kuntur_blanco.png') }}" alt="Kuntur Logo" class="background-logo">
</div>

<!-- Header con logo -->
<nav class="navbar-custom px-4 d-flex justify-content-between align-items-center">
  <div class="d-flex align-items-center">
    <div class="logo-circle-nav">
      <img src="{{ url_for('static', filename='Kuntur_blanco.png') }}" alt="Logo Kuntur" class="logo-img-nav"/>
    </div>
    <div class="brand-text-nav ms-3">
      <span class="brand-name-nav">KUNTUR</span>
      <span class="brand-subtitle-nav">Sistema Anti-Extorsiones</span>
    </div>
  </div>
  <div class="user-info">
    <span class="user-name">{{ nombre_local }}</span>
    <span class="user-location">📍 {{ ubicacion }}</span>
    <span> <a class="nav-link" href="{{ url_for('alerta.mis_alertas') }}">📋 Mis Alertas</a> </span>
  </div>
</nav>

<!-- Contenido -->
<div class="dashboard-container">
  <div class="dashboard-content">
    <!-- Cámara -->
    <div class="camera-section">
      <div class="card-modern camera-card">
        <div class="card-header-modern">
          <h5 class="card-title-modern">📹 Cámara de Seguridad</h5>          
        </div>
        <div class="card-body-modern camera-container">
          <img src="{{ url_for('stream.video_feed') }}" alt="Cámara en vivo" class="camera-feed" id="video_feed">
        </div>
      </div>
    </div>

    <!-- Lateral derecho -->
    <div class="sidebar-section">
      <!-- Control del sistema -->
      <div class="card-modern control-card">
        <div class="card-header-modern">
          <h6 class="card-title-modern">🛡️ Control del Sistema</h6>
        </div>
        <div class="card-body-modern">
          <!-- Estado dispositivos -->
          <div class="device-status">
            <div class="status-item">
              <span class="device-icon">📷</span>
              <span class="device-name">Cámara</span>
              <div class="status-group">
                <span id="estado-cam" class="status-badge loading">Cargando...</span>
                <span id="estado-cam-grabando" class="status-badge secondary">---</span>
              </div>
            </div>

            <div class="status-item">
              <span class="device-icon">🎤</span>
              <span class="device-name">Micrófono</span>
              <div class="status-group">
                <span id="estado-mic" class="status-badge loading">Cargando...</span>
                <span id="estado-mic-grabando" class="status-badge secondary">---</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Alertas recientes -->
      <div class="card-modern alerts-card">
        <div class="card-header-modern">
          <h6 class="card-title-modern">🚨 Alertas Recientes</h6>
        </div>
        <div class="card-body-modern">
          <div id="alert-container" class="alerts-container">
            <!-- Las alertas se cargan aquí dinámicamente -->
          </div>
        </div>
      </div>

      <!-- Alerta Manual (reemplaza transcripción) -->
      <div class="card-modern manual-alert-card">
        <div class="card-header-modern">
          <h6 class="card-title-modern">Activación Manual</h6>
        </div>
        <div class="card-body-modern text-center">
          <button class="btn-alert-manual-large" id="activarAlertaManual">
            🚨 ACTIVAR ALERTA MANUAL
          </button>
          <p class="alert-description mt-3">
            Presiona este botón si detectas una situación de emergencia que requiere atención inmediata de las autoridades.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
<div id="fullscreen-alert" class="fullscreen-alert d-none"></div>


<!-- Footer -->
<footer class="footer-custom">
  <div class="footer-content">
    <span>© 2025 Kuntur Security Systems. Todos los derechos reservados.</span>
  </div>
</footer>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='alerta_manual.js') }}"></script>
<script src="{{ url_for('static', filename='sensores.js') }}"></script>
<script src="{{ url_for('static', filename='sse.js') }}"></script>
<script src="{{ url_for('static', filename='app.js') }}"></script>

</body>
</html>